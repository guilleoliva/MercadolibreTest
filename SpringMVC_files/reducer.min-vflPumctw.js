define(["require","exports","tslib","modules/constants/comments_panel","modules/clean/react/file_sidebar/store/sidebar/types","modules/clean/react/file_sidebar/store/sidebar/actions"],function(e,t,o,n,s,a){"use strict";function i(e,n){switch(n.type){case s.ActionType.SidebarReset:return o.__assign({},t.INITIAL_STATE,{open:e.open});case s.ActionType.SidebarOpen:return o.__assign({},e,{open:!0,openReason:n.payload.reason});case s.ActionType.SidebarClose:return o.__assign({},e,{open:!1,openReason:void 0});case s.ActionType.SidebarSelectTab:return o.__assign({},e,{activeTab:n.payload.tabName});case s.ActionType.SidebarOpenFile:var a=n.payload,i=a.file,r=a.isVersionHistoryMode,c=a.user;return o.__assign({},e,{openReason:void 0,context:{file:i,isVersionHistoryMode:r,user:c},tabs:{activity:{ready:!c,show:r===!1&&e.tabs.activity.show,count:0},comments:{ready:!1,show:!1,count:0,extra:{commentCount:0,videoAnnotationPermissionStatus:e.tabs.comments.extra.videoAnnotationPermissionStatus}}}});case"FILE_ACTIVITY|LOADING_END":return o.__assign({},e,{tabs:o.__assign({},e.tabs,{activity:{ready:!0,show:e.context.isVersionHistoryMode===!1&&n.state.enabled,count:0}})});case s.ActionType.SidebarSetCommentState:var m=n.payload,d=m.enabled,b=m.canEnable,u=m.commentCount,y=m.initialized,_=m.ready,p=m.unreadCommentCount,v=e.tabs.comments.ready,S=e.tabs.comments.show,T=v||y&&_,A=!T||!v&&T&&(d||b)||S;return o.__assign({},e,{tabs:o.__assign({},e.tabs,{comments:{ready:T,show:A,count:p,extra:{commentCount:u,videoAnnotationPermissionStatus:e.tabs.comments.extra.videoAnnotationPermissionStatus}}})});case s.ActionType.SidebarSetVideoAnnotationsPrototypeState:var l=n.payload.shouldShow;return o.__assign({},e,{tabs:o.__assign({},e.tabs,{comments:{ready:l,show:l,count:0,extra:{commentCount:0,videoAnnotationPermissionStatus:e.tabs.comments.extra.videoAnnotationPermissionStatus}}})});case s.ActionType.SidebarSetVideoAnnotationFetchStatus:var h=n.payload.status;return o.__assign({},e,{tabs:o.__assign({},e.tabs,{comments:o.__assign({},e.tabs.comments,{ready:!0,extra:{commentCount:0,videoAnnotationPermissionStatus:h}})})})}return e}function r(e,o){void 0===e&&(e=t.INITIAL_STATE);var n=i(e,o);return n.ready=e.ready||n.tabs.activity.ready&&n.tabs.comments.ready,!e.ready&&n.ready&&(n.tabs.comments.show&&!n.tabs.activity.show?n.activeTab="comments":!n.tabs.comments.show&&n.tabs.activity.show&&(n.activeTab="activity"),n.tabs.comments.show&&n.tabs.comments.count>0&&(n.open=!0,n.openReason=n.openReason||"unread_comments",n.activeTab="comments"),"comments"===n.activeTab?a.LegacyCommentsStoreAction.showComments():a.LegacyCommentsStoreAction.hideComments()),n.ready&&n.open&&!n.openReason&&(n.openReason="sticky_state"),!n.open||"comments"!==n.activeTab||e.open&&"comments"===e.activeTab?!e.open||"comments"!==e.activeTab||n.open&&"comments"===n.activeTab||a.LegacyCommentsStoreAction.hideComments():a.LegacyCommentsStoreAction.showComments(),n}Object.defineProperty(t,"__esModule",{value:!0});var c=n.SHOW_COMMENTS_PANEL||!1;t.INITIAL_STATE={activeTab:"comments",open:c,openReason:void 0,ready:!1,context:{file:void 0,isVersionHistoryMode:void 0,user:void 0},tabs:{activity:{ready:!1,show:!1,count:0},comments:{ready:!1,show:!1,count:0,extra:{commentCount:0,videoAnnotationPermissionStatus:s.VideoAnnotationsPermissionStatus.NOT_YET_RECEIVED}}}},t.reducer=r});
//# sourceMappingURL=reducer.min.js-vfl5XEuKm.map