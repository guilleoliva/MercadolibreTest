define(["require","exports","tslib","external/classnames","external/react","jquery","modules/clean/video_annotations_prototype/components/video_comment","modules/clean/video_annotations_prototype/store/selectors","external/react-redux","modules/clean/video_annotations_prototype/store/actions","modules/clean/video_annotations_prototype/video_annotation_prototype_helper","modules/clean/video_annotations_prototype/video_preview_event_emitter","modules/clean/video_annotations_prototype/constants","modules/clean/react/css","modules/clean/video_annotations_prototype/components/video_comment_input_box"],function(e,t,n,o,i,r,d,a,s,m,c,l,u,p,v){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var f=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={focusedGid:null},t.handleVideoToggled=function(e,n,o){t.setState({videoLength:n})},t.setFocusedComment=function(e){t.setState({focusedGid:e})},t.handlePaneClick=function(e){e.target===e.currentTarget&&t.setState({focusedGid:null})},t}return n.__extends(t,e),t.prototype.refreshWidth=function(){if(r(".video-js").length)return r(".video-js").css("width","100%")},t.prototype.componentDidMount=function(){this.refreshWidth(),l.videoPreviewEventEmitter.addListener(u.EventTypes.VIDEO_TOGGLED,this.handleVideoToggled)},t.prototype.componentWillUnmount=function(){l.videoPreviewEventEmitter.removeListener(u.EventTypes.VIDEO_TOGGLED,this.handleVideoToggled)},t.prototype.render=function(){var e=this,t=o({"file-feedback":!0,"file-feedback--border":!0,"file-feedback--minimized":!1,"preview-ready":!0,hidden:!1}),n=this.props,r=n.comments,a=n.ownersToNotify,s=n.file,m=n.linkUrl,l=n.user,u=n.hasOnboarded,p=n.addComment,f=n.deleteComment,_=n.resolveComment,h=n.dismissOnboardingBubble,y=l&&l.id,C=this.state,g=C.focusedGid,b=C.videoLength;if(!s)return null;var E=c.VideoAnnotationPrototypeHelper.shouldShowSimplifiedVideoPrototype(s),T=!E&&y?function(e){return f(y,s,m,e)}:void 0,w=!E&&y?function(e){return _(y,s,m,e)}:void 0,O=void 0,x=function(e){};y&&s&&(O=function(e){return p(y,s,m,e)},x=function(e){return function(t){return p(y,s,m,t,e)}});var k=y?function(){return h(y)}:void 0,V=function(t){return function(){return e.setFocusedComment(t)}},S=i.createElement("div",{className:"logged-out-hint"},"Sign in to leave a comment"),G=this.copyAndSortCommentThreads(r);return i.createElement("div",{className:"experimental-annotations-pane",tabIndex:-1},l?i.createElement(v.VideoCommentInputBox,{addComment:O,user:l,renderCoachmark:!u,onCoachmarkClose:k,ownersToNotify:a}):S,i.createElement("div",{className:t,onClick:this.handlePaneClick},G.map(function(e){return i.createElement(d.VideoCommentSubthread,{key:e.comment_gid,collapsed:e.comment_gid!==g,comment:e,deleteComment:T,onExpand:V(e.comment_gid),resolveComment:w,replyToComment:x(e.comment_gid),user:l,videoLength:b,ownersToNotify:a})})))},t.prototype.copyAndSortCommentThreads=function(e){var t=e.slice();return t.sort(function(e,t){var n=e.comment_metadata.frame_time,o=t.comment_metadata.frame_time;return n===o?t.when_created-e.when_created:n===-1?1:o===-1?-1:n-o}),t},t})(i.Component),_=function(e){return{comments:a.getComments(e),hasOnboarded:a.getHasOnboarded(e),ownersToNotify:a.getOwnersToNotify(e)}},h=p(f,["/static/css/video_annotation_prototype-vflTNW3Fa.css"]),y=s.connect(_,{addComment:m.addComment,deleteComment:m.deleteComment,resolveComment:m.resolveComment,dismissOnboardingBubble:m.dismissOnboardingBubble})(h);t.VideoAnnotationsPane=y});
//# sourceMappingURL=video_annotations_pane.min.js-vflyFngEu.map