define("modules/clean/admin/megaphone/prompt/api/utils",["require","exports","tslib"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r;(function(e){var t=function(e){return e.replace(/_(.)/g,function(e,t){return t.toUpperCase()})},n=function(e){return e.replace(/([a-z\d])([A-Z0-9])/g,function(e,t,n){return t+"_"+n.toLowerCase()})},r=function(e,t){if(null===t)return null;if(Array.isArray(t)){var n=[];return t.forEach(function(t){n.push(r(e,t))}),n}if("object"==typeof t){var o={};return Object.keys(t).forEach(function(n){o[e(n)]=r(e,t[n])}),o}return t},o=function(e,t){return r(e,t)},i=function(e){var t={},r=o(n,e);return Object.keys(r).forEach(function(e){r[e]&&r[e].id?t[e]=r[e].id:t[e]=r[e]}),t.approved=!(!t.approved_time&&!t.approved_user),delete t.approved_time,delete t.approved_user_id,t.start_time_enabled=!!t.ad&&!!t.ad.start_time,t.end_time_enabled=!!t.ad&&!!t.ad.end_time,t.remind_me_later_enabled=!!t.remind_me_later_type,t.remind_me_later_enabled||(t.remind_me_later_type=null,t.remind_me_later_delay=null),Object.keys(t).forEach(function(e){"boolean"==typeof t[e]&&(t[e]=t[e]?"on":"off")}),t.upsell_promo_spec=t.cash_promo,delete t.cash_promo,delete t.id,delete t.created_time,delete t.promo_params,delete t.updated_time,delete t.user,delete t.locale,t};e.requestDataFromCampaignAndVersion=function(e,t){var r=i(e),s=o(n,t.content);delete r.content;var a=["modal_type"];return Object.keys(s).forEach(function(e){if(a.includes(e))r[e]=s[e];else{if(null===s[e])return;var t=void 0;t=Array.isArray(s[e])?s[e].join("\n"):s[e],r["content["+e+"]"]=t}}),r.stormcrow_variant=t.stormcrowVariant,"content[image_url]"in r&&(r["content[image]"]=r["content[image_url]"],delete r["content[image_url]"]),"content[cancel_with_xIcon]"in r&&(r["content[cancel_with_x_icon]"]=r["content[cancel_with_xIcon]"],delete r["content[cancel_with_xIcon]"]),Object.keys(r).forEach(function(e){"boolean"==typeof r[e]&&(r[e]=r[e]?"on":"off")}),r},e.toCamelCase=function(e){return o(t,e)},e.jsonToCamelCase=function(t){var n=JSON.parse(t);return e.toCamelCase(n)},e.stringToCamelCase=function(e){return t(e)}})(r=t.APIUtils||(t.APIUtils={})),t.isCampaignResult=function(e){return void 0===e.active},t.campaignResultToCampaign=function(e){return{active:"approved"===e.lifecycle_state[".tag"]&&!!e.ad&&!!e.ad.lifecycle_state&&"active"===e.ad.lifecycle_state[".tag"],ad:e.ad?{end_time:0,priority:0,start_time:0}:null,approved_time:0,approved_user_id:e.approved_user_id,archived:"archived"===e.lifecycle_state[".tag"],campaign_type:{global_dismiss_duration:"",global_dismiss_ns:"",id:e.campaign_type_id,max_dismiss_count:0,name:e.campaign_type_name,description:"",priority:0,recycle_delays:[],cash_promos:[]},cash_promo:null,content:{},created_time:0,description:e.description,for_logged_in:!!e.for_logged_in,for_logged_out:!!e.for_logged_out,id:e.id?e.id:0,locale:{supported_locales:[],translated_locales:[]},location:e.location_id,name:e.name,new_user_grace_period:null,remind_me_later_type:null,remind_me_later_delay:null,source_locale:{id:e.source_locale_id||"",name:e.source_locale_name},stormcrow_feature:e.stormcrow_feature,stormcrow_variant:"",tags:[],updated_time:0,user:{id:0}}},t.versionResultToVersion=function(e){var t=r.toCamelCase(n.__assign({},e.content));return delete t[".tag"],{id:0,name:"",stormcrowVariant:"",content:t}},t.isVersion=function(e){return void 0!==e.id},t.isCreateVersionArg=function(e){return void 0===e.id},t.versionResultToUpdateVersionArg=function(e){return{id:e.id,content:e.content,description:e.description,name:e.name,stormcrow_variant:e.stormcrow_variant}},t.isAdActive=function(e){return!!e.ad&&!!e.ad.lifecycle_state&&"active"===e.ad.lifecycle_state[".tag"]},t.isCampaignArchived=function(e){return"archived"===e.lifecycle_state[".tag"]},t.isCampaignApproved=function(e){return"approved"===e.lifecycle_state[".tag"]},t.isVersionApproved=function(e){return"approved"===e.lifecycle_state[".tag"]},t.isVersionArchived=function(e){return"archived"===e.lifecycle_state[".tag"]},t.isVersionPending=function(e){return"pending_approval"===e.lifecycle_state[".tag"]}}),define("modules/clean/ajax_minimal",["require","exports"],function(e,t){"use strict";function n(e){var t=document.cookie.match("(^|; )"+e+"=([^;]*)");return t?t[2]:""}function r(e,t){var r=new XMLHttpRequest;r.open("POST",e),r.withCredentials=!0,r.setRequestHeader("X-CSRF-Token",n("__Host-js_csrf")),r.send(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.post=r}),define("modules/clean/deprecated/uirequest",["require","exports","external/lodash","jquery","modules/clean/ajax","modules/clean/css","modules/clean/dbmodal","modules/clean/legacy_pyxl_controllers/ajax_form","modules/core/html","modules/core/i18n","modules/core/notify","modules/pagelet_config"],function(e,t,n,r,o,i,s,a,c,p,l,m){"use strict";return(function(){function e(e,t,r){if(null==r&&(r={}),this.success=this.success.bind(this),this.perform_actions=this.perform_actions.bind(this),this.error=this.error.bind(this),this.handle_errors=this.handle_errors.bind(this),this.complete=this.complete.bind(this),this.$node=e,this.url=t,this.options=r,this.shouldDelayComplete=!1,this.$node.hasClass("ajax-loading"))return!1;this.$node.addClass("ajax-loading"),o.FormWebRequest({url:this.url,type:null!=this.options.type?this.options.type:void 0,data:this.options.data||{},success:this.success,error:this.error,complete:this.complete,subject_user:this.options.subject_user,headers:n.assignIn({"X-RequireJS-Context":m.REQUIREJS_CONFIG.context,"X-UIRequest-Version":3},this.options.headers)})}return e.prototype.success=function(e,t,n){var r=this,o=a.extract_errors(n.responseText);return o?(this.handle_errors(o),void("function"==typeof this.options.error&&this.options.error(n,t))):(e=JSON.parse(n.responseText),e.redirect?void(window.location.href=e.redirect):e.reload?void window.location.reload():(this.shouldDelayComplete=e.js||e.css,this.shouldDelayComplete?i.require_css_multi(e.css,function(){return r.perform_actions(e.actions||[]),"function"==typeof r.options.success&&r.options.success(e,t,n),r.$node.removeClass("ajax-loading"),"function"==typeof r.options.complete?r.options.complete(n,t):void 0}):(this.perform_actions(e.actions||[]),void("function"==typeof this.options.success&&this.options.success(e,t,n)))))},e.prototype.perform_actions=function(e){var t=this;return(function(){for(var n=[],o=0,i=Array.from(e);o<i.length;o++){var a=i[o],p=Array.from(a),m=p[0],u=p[1],d=p[2],_=t.$node;if(d&&"modal"!==m){if("^"===d.charAt(0)){var f=d.split(" ");_=_.closest(f[0].substr(1)),d=f.slice(1).join(" ")}d&&(_=_.find(d).filter(":first"))}switch(m){case"modal":;r("#db-modal-response-modal-placeholder").remove();var h=r(u);h.attr("id","db-modal-response-modal-placeholder"),r("body").append(h);var g=new s.DBModal({element_id:"response-modal-placeholder"});n.push(g.show());break;case"html":n.push(_.html(u));break;case"replaceWith":n.push(_.replaceWith(u));break;case"after":u?n.push(_.after(u)):n.push(void 0);break;case"before":u?n.push(_.before(u)):n.push(void 0);break;case"toggleClass":n.push(_.toggleClass(u));break;case"addClass":n.push(_.addClass(u));break;case"removeClass":n.push(_.removeClass(u));break;case"notify":n.push(l.Notify.success(u));break;case"notifyError":n.push(l.Notify.error(new c.HTML(u),t.options.errorDuration||void 0));break;default:n.push(void 0)}}return n})()},e.prototype.error=function(e,t,n){var r=a.extract_errors(e.responseText);return"abort"!==t&&this.handle_errors(r),"function"==typeof this.options.error?this.options.error(e,t,n):void 0},e.prototype.handle_errors=function(e){if(e===!1)return l.Notify.error(p._("There was a problem completing this request."));if("string"==typeof e){var t=void 0;return t=this.options.html_in_error_msg?new c.HTML(e):e,l.Notify.error(t)}return a.fill_errors(this.$node,e)},e.prototype.complete=function(e,t){if(!this.shouldDelayComplete)return this.$node.removeClass("ajax-loading"),"function"==typeof this.options.complete?this.options.complete(e,t):void 0},e})()}),define("modules/clean/prompt/api/rendering",["require","exports"],function(e,t){"use strict";function n(e){return void 0!==e.remindMeLaterText}Object.defineProperty(t,"__esModule",{value:!0}),t.isHomeModalContent=n}),define("modules/clean/prompt/ha_loader",["require","exports","modules/clean/admin/megaphone/prompt/api/utils","external/react","external/react-dom","modules/clean/ajax","modules/clean/upsell/exception","modules/clean/react/prompt/ha"],function(e,t,n,r,o,i,s,a){"use strict";function c(e){if(!e.userID)return Promise.reject(null);var t=document.querySelector("#prompt-silo .ha-silo");return new Promise(function(c,p){try{i.SilentBackgroundRequest({url:"/prompt/ha",subject_user:e.userID,data:{ref_controller:e.controller,ref_action:e.action}}).then(function(i){var s=n.APIUtils.jsonToCamelCase(i);s.campaign&&(s.subjectUser=e.userID,o.render(r.createElement(a.HA,s),t)),c()})}catch(t){s.reportException({err:t,tags:[s.TAGS.PROMPT_HA_LOADER],exc_extra:{param_user_id:e.userID,param_controller:e.controller,param_action:e.action}}),p()}})}Object.defineProperty(t,"__esModule",{value:!0}),t.initialize_module=c}),define("modules/clean/prompt/react_loader",["require","exports","modules/clean/admin/megaphone/prompt/api/utils","external/react","external/react-dom","modules/clean/upsell/exception","modules/clean/react/prompt/header_link","modules/clean/react/prompt/header_bubble","modules/clean/react/prompt/home_modal"],function(e,t,n,r,o,i,s,a,c){"use strict";function p(e){if(e.userID)for(var t=0,p=e.campaigns;t<p.length;t++){var m=p[t];try{var u=n.APIUtils.toCamelCase(m);if(u&&u.campaign)switch(u.subjectUser=e.userID,u.campaign.campaignLocationId){case"HEADER_LINK":var d=l(e);d&&o.render(r.createElement(s.HeaderLink,u),d);break;case"HEADER_BUBBLE":var _=l(e);_&&o.render(r.createElement(a.HeaderBubble,u),_);break;case"HOME_MODAL":c.HomeModal.showInstance(u)}}catch(t){i.reportException({err:t,tags:[i.TAGS.PROMPT_REACT_LOADER],exc_extra:{param_user_id:e.userID,param_controller:e.controller,param_action:e.action,param_campaign_response:m}})}}}function l(e){var t="#prompt-silo .account-header-react-silo",n=document.querySelector(t);return n||i.reportException({err:new Error("Could not locate mount point "+t),tags:[i.TAGS.PROMPT_REACT_LOADER],exc_extra:{param_user_id:e.userID,param_controller:e.controller,param_action:e.action}}),n}Object.defineProperty(t,"__esModule",{value:!0}),t.initialize_react=p}),define("modules/clean/react/prompt/button",["require","exports","tslib","external/classnames","external/purify","external/react","modules/core/cookies","modules/clean/prompt/api/rendering"],function(e,t,n,r,o,i,s,a){"use strict";function c(e){return e?{__html:o.sanitize(e)}:void 0}function p(e){function t(){return e.campaign.content.confirmText?i.createElement(l,{className:"button-primary",confirmInNewTab:e.campaign.content.confirmInNewTab,confirmIsPost:e.confirmIsPost,confirmUrl:e.confirmUrl,onConfirm:e.onConfirm,html:e.campaign.content.confirmText}):null}function n(){var t=e.campaign,n=e.onRemindMeLater;return a.isHomeModalContent(t.content)&&t.content.remindMeLaterText&&n?i.createElement(m,{className:"remind-me-later cancel-button button-tertiary",onDismiss:n,html:t.content.remindMeLaterText}):null}function o(){var t=e.campaign,n=e.onDismiss,o=e.onRemindMeLater,s={"cancel-button":!0};return t.content.cancelText?(a.isHomeModalContent(t.content)&&t.content.remindMeLaterText&&o?s["cancel-link"]=!0:s["button-tertiary"]=!0,i.createElement(m,{className:r(s),onDismiss:n,html:t.content.cancelText||void 0})):null}return i.createElement("div",{className:"upsell-buttons"},t(),n(),o())}Object.defineProperty(t,"__esModule",{value:!0}),t.sanitizeOptionalHTML=c;var l=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(t,e),t.prototype.render=function(){var e=r(this.props.className,{"confirm-button":!0,enabled:!0});if(this.props.confirmIsPost){var t=s.Cookies.read("__Host-js_csrf");return i.createElement("form",{className:"form-button-primary",action:this.props.confirmUrl,method:"POST",target:this.getTarget(),onSubmit:this.props.onConfirm},i.createElement("input",{type:"hidden",name:"t",value:t}),i.createElement("button",{type:"submit",className:e,dangerouslySetInnerHTML:c(this.props.html)},this.props.children))}return i.createElement("a",{href:this.props.confirmUrl,className:e,target:this.getTarget(),dangerouslySetInnerHTML:c(this.props.html),onClick:this.props.onConfirm},this.props.children)},t.prototype.getTarget=function(){return this.props.confirmInNewTab?"_blank":"_self"},t})(i.Component);t.ConfirmButton=l;var m=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(t,e),t.prototype.render=function(){var e=r(this.props.className,{"dismiss-button":!0,enabled:!0});return i.createElement("a",{href:"#",className:e,dangerouslySetInnerHTML:c(this.props.html),onClick:this.props.onDismiss},this.props.children)},t})(i.Component);t.DismissButton=m,t.PromptButtons=p}),define("modules/clean/react/prompt/campaign_state_manager",["require","exports","tslib","modules/core/uri","modules/clean/upsell/upsell_controller","modules/clean/upsell/prompt_event_logger"],function(e,t,n,r,o,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=(function(){function e(e){var t=this;this.onShow=function(){t.component.state.isShown||(t.component.setState(function(e){return n.__assign({},e,{isShown:!0})}),t.eventLogger.triggerExternalEvent(o.ON_SHOW_EVENT_NAME),t.eventLogger.recordClientImpression())},this.onConfirm=function(e){t.confirm(),t.component.props.campaign.content.confirmInNewTab||t.getShouldUsePost()||e.preventDefault()},this.onDismiss=function(e,r){t.isAckInProgress()||(t.component.setState(function(e){return n.__assign({},e,{isDismissed:!0})}),e.preventDefault(),t.eventLogger.triggerExternalEvent(o.PRE_DISMISS_EVENT_NAME),t.eventLogger.recordDismiss(r&&r.remindMeLater))},this.attachListenersToChildren=function(e,n,r){if(e){for(var o=e.querySelectorAll(".confirm-button"),i=0;i<o.length;i++)o[i].addEventListener("click",n||t.onConfirm);for(var s=e.querySelectorAll(".dismiss-button, .db-modal-x, .db-modal-overlay"),i=0;i<s.length;i++)s[i].addEventListener("click",r||t.onDismiss)}},this.component=e,this.eventLogger=new i.PromptEventLogger(this.component.props)}return e.prototype.getConfirmUrl=function(){if("#"===this.component.props.campaign.content.confirmUrl)return"#";var e=this.eventLogger.getUpsellControllerURI("/prompt/confirm_v2"),t=this.component.props.campaign.content.confirmIsPost,n=this.getRedirectURL();return n&&e.updateQuery({redirect_url:n}),t&&e.updateQuery({preserve_post:"1"}),e.toString()},e.prototype.getShouldUsePost=function(){return!!(this.component.props.campaign.content.confirmUrl&&"#"!==this.component.props.campaign.content.confirmUrl||this.component.props.campaign.content.confirmIsPost)},e.prototype.confirm=function(){this.isAckInProgress()||(this.component.setState(function(e){return n.__assign({},e,{isConfirmed:!0})}),this.eventLogger.triggerExternalEvent(o.PRE_CONFIRM_EVENT_NAME),this.getShouldUsePost()||this.eventLogger.recordConfirm())},e.prototype.getRedirectURL=function(){if(this.component.props.campaign.addTkParams&&this.getShouldUsePost()){var e=r.URI.parse(this.component.props.campaign.content.confirmUrl),t=this.component.props.campaign.versionId;return null==t&&(t=this.component.props.campaign.campaignId),e.updateQuery({_tk:this.component.props.campaign.campaignLocationTkId,_camp:t.toString()}),e.toString()}return this.component.props.campaign.content.confirmUrl},e.prototype.isAckInProgress=function(){return this.component.state.isConfirmed||this.component.state.isDismissed},e})();t.CampaignStateManager=s}),define("modules/clean/react/prompt/ha",["require","exports","tslib","jquery","external/classnames","external/react","external/react-dom","modules/clean/react/css","modules/clean/react/sprite","modules/clean/upsell/prompt_event_emitter","modules/clean/react/prompt/button","modules/clean/react/prompt/image","modules/clean/react/prompt/prompt_location","modules/core/i18n"],function(e,t,n,r,o,i,s,a,c,p,l,m,u,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var _;(function(e){e[e.HIDE=1]="HIDE",e[e.NO_IMAGE=2]="NO_IMAGE",e[e.SHOW=3]="SHOW"})(_=t.ShowState||(t.ShowState={})),t.UpdateInterval=1e3;var f=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(t,e),t.prototype.renderImage=function(){var e=this.props.content;return e.imageUrl?i.createElement(l.ConfirmButton,{className:"confirm-button--illustration",confirmInNewTab:e.confirmInNewTab,confirmIsPost:this.props.confirmIsPost,confirmUrl:this.props.confirmUrl,onConfirm:this.props.onConfirm},i.createElement(m.Image,{src:e.imageUrl,srcHiRes:e.imageUrlHiRes,alt:e.confirmText,onLoad:this.props.onImageLoad})):null},t.prototype.renderText=function(){var e=this.props.content;return i.createElement("p",null,i.createElement(l.ConfirmButton,{confirmInNewTab:e.confirmInNewTab,confirmIsPost:this.props.confirmIsPost,confirmUrl:this.props.confirmUrl,html:e.text,onConfirm:this.props.onConfirm}))},t.prototype.renderConfirmButton=function(){var e=this.props.content;return e.confirmText?i.createElement(l.ConfirmButton,{className:"button",confirmInNewTab:e.confirmInNewTab,confirmIsPost:this.props.confirmIsPost,confirmUrl:this.props.confirmUrl,html:e.confirmText,onConfirm:this.props.onConfirm}):null},t.prototype.renderDismissButton=function(){return i.createElement(l.DismissButton,{onDismiss:this.props.onDismiss,"aria-label":d._("Close")},i.createElement(c.Sprite,{group:"web",name:"close_small",alt:d._("Close")}))},t.prototype.render=function(){var e=this.props.isDismissed,t=o({ha:!0,"no-image":!e&&this.props.showState===_.NO_IMAGE,visible:!e&&this.props.showState===_.SHOW,invisible:this.props.isInvisible});return i.createElement("div",{className:t},this.renderImage(),this.renderText(),this.renderConfirmButton(),this.renderDismissButton())},t.displayName="HARendererWithoutCSS",t})(i.Component);t.HARendererWithoutCSS=f,t.HARendererWithCSS=a(f,["/static/css/upsell/prompt_pagelet-vflbYkUc5.css"]);var h=(function(e){function o(t){var n=e.call(this,t,{cloneShowState:_.SHOW,isConfirmed:!1,isDismissed:!1,isShown:!1,showState:_.HIDE})||this;return n.setHaRef=function(e){n.ha=e},n.setHaCloneRef=function(e){n.haClone=e},n.onPageUpdate=n.onPageUpdate.bind(n),n}return n.__extends(o,e),o.prototype.componentDidMount=function(){this.onUpdate(),r(window).resize(this.onPageUpdate),p.Emitter.addListener(p.Events.REACT_HA_DID_UPDATE,this.onPageUpdate),this.intervalID=setInterval(this.onPageUpdate,t.UpdateInterval)},o.prototype.componentWillUnmount=function(){r(window).off("resize",this.onPageUpdate),p.Emitter.off(p.Events.REACT_HA_DID_UPDATE,this.onPageUpdate),clearInterval(this.intervalID)},o.prototype.componentDidUpdate=function(){this.onUpdate()},o.prototype.onPageUpdate=function(){this.setState(function(e){return e.cloneShowState=_.SHOW,e})},o.prototype.onUpdate=function(){var e=this;if(this.state.cloneShowState>_.HIDE&&this.canFit())this.state.showState!==this.state.cloneShowState&&this.setState(function(e){return e.showState=e.cloneShowState,e},function(){e.state_manager.onShow()});else{var t=this.state.cloneShowState-1;t>_.HIDE?this.setState(function(e){return e.cloneShowState=t,e}):this.state.showState!==_.HIDE&&this.setState(function(e){return e.showState=_.HIDE,e})}},o.prototype.render=function(){return i.createElement("div",null,i.createElement(t.HARendererWithCSS,{isInvisible:!1,content:this.props.campaign.content,confirmUrl:this.state_manager.getConfirmUrl(),confirmIsPost:this.state_manager.getShouldUsePost(),isDismissed:this.state.isDismissed,onConfirm:this.state_manager.onConfirm,onDismiss:this.state_manager.onDismiss,ref:this.setHaRef,showState:this.state.showState}),i.createElement(t.HARendererWithCSS,{isInvisible:!0,content:this.props.campaign.content,confirmUrl:this.state_manager.getConfirmUrl(),confirmIsPost:this.state_manager.getShouldUsePost(),isDismissed:this.state.isDismissed,onConfirm:this.state_manager.onConfirm,onDismiss:this.state_manager.onDismiss,onImageLoad:this.onPageUpdate,ref:this.setHaCloneRef,showState:this.state.cloneShowState}))},o.prototype.canFit=function(){var e=this.getMenuHeight();if(null===e)return!1;var t=this.getHAHeight();return null!==t&&e+t<=this.getWindowHeight()},o.prototype.getHAHeight=function(){var e=r(s.findDOMNode(this.haClone));if(0===e.length)return null;return e.outerHeight()+75},o.prototype.getMenuHeight=function(){var e=r(".maestro-secondary-sidebar, .appactions-menu").first();if(0===e.length)return null;var t=e.children(),n=e.offset().top-r(document).scrollTop();return t.each(function(e,t){n+=r(t).outerHeight(!0)}),n},o.prototype.getWindowHeight=function(){return r(window).height()},o})(u.PromptLocation);t.HA=h}),define("modules/clean/react/prompt/header_bubble",["require","exports","tslib","external/react","external/classnames","modules/clean/react/css","modules/clean/react/prompt/prompt_location","modules/clean/react/prompt/header_link","modules/clean/react/prompt/image","modules/clean/react/prompt/button"],function(e,t,n,r,o,i,s,a,c,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(t,e),t.prototype.componentDidMount=function(){this.state_manager.onShow()},t.prototype.render=function(){var e=this.props.campaign.content,t=r.createElement("div",null,r.createElement("p",{className:"message",dangerouslySetInnerHTML:p.sanitizeOptionalHTML(e.text),ref:this.state_manager.attachListenersToChildren}),r.createElement(p.PromptButtons,{campaign:this.props.campaign,confirmIsPost:this.state_manager.getShouldUsePost(),confirmUrl:this.state_manager.getConfirmUrl(),onConfirm:this.state_manager.onConfirm,onDismiss:this.state_manager.onDismiss})),n=o({"header-bubble-container":!0,show:!0,"header-bubble-container--with-image":!!e.imageUrl}),i=e.imageUrl?[r.createElement("div",{className:"left"},r.createElement(p.ConfirmButton,{className:"image-button",confirmInNewTab:e.confirmInNewTab,confirmUrl:this.state_manager.getConfirmUrl(),confirmIsPost:this.state_manager.getShouldUsePost(),onConfirm:this.state_manager.onConfirm},r.createElement(c.Image,{src:e.imageUrl,srcHiRes:e.imageUrlHiRes,alt:e.confirmText}))),r.createElement("div",{className:"right"},t)]:[t],s=["top-level-nav-item"];return this.state.isConfirmed||this.state.isDismissed||s.push("active"),r.createElement("li",{className:s.join(" ")},r.createElement(a.HeaderLinkRendererWithoutCSS,{content:e,confirmUrl:this.state_manager.getConfirmUrl(),onConfirm:this.state_manager.onConfirm}),r.createElement("div",{className:"sub-nav chat-bubble header-bubble upsell-bubble",id:"upsell-bubble"},r.createElement("div",{className:n},i,r.createElement("div",{className:"chat-bubble-arrow-border"}),r.createElement("div",{className:"chat-bubble-arrow"}))))},t.displayName="HeaderBubbleWithoutCSS",t})(s.PromptLocationWithDefaultState);t.HeaderBubbleWithoutCSS=l,t.HeaderBubble=i(l,["/static/css/upsell/prompt_pagelet-vflbYkUc5.css"])}),define("modules/clean/react/prompt/header_link",["require","exports","tslib","external/react","modules/clean/react/css","modules/clean/react/prompt/prompt_location","modules/clean/react/sprite_div"],function(e,t,n,r,o,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(t,e),t.prototype.render=function(){var e=this.props.content,t=["confirm-button","header-nav-link","enabled"];e.linkPretext&&t.push("header-nav-link--bold");var n;n=e.linkIcon?r.createElement("a",{className:t.join(" "),href:this.props.confirmUrl,onClick:this.props.onConfirm},r.createElement(s,{group:"web",name:e.linkIcon,text:e.linkText})):r.createElement("a",{className:t.join(" "),href:this.props.confirmUrl,onClick:this.props.onConfirm},e.linkText);var o=n;return e.linkPretext&&(o=r.createElement("div",{className:"header-nav-link--space"},r.createElement("span",{className:"header-link__pretext"},e.linkPretext),n)),r.createElement("div",{className:"header-link"},o)},t.displayName="HeaderLinkRendererWithoutCSS",t})(r.Component);t.HeaderLinkRendererWithoutCSS=a;var c=o(a,["/static/css/upsell/prompt_pagelet-vflbYkUc5.css"]),p=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(t,e),t.prototype.componentDidMount=function(){this.state_manager.onShow()},t.prototype.render=function(){return r.createElement("li",{className:"top-level-nav-item"},r.createElement(c,{content:this.props.campaign.content,confirmUrl:this.state_manager.getConfirmUrl(),onConfirm:this.state_manager.onConfirm}))},t})(i.PromptLocationWithDefaultState);t.HeaderLink=p}),define("modules/clean/react/prompt/home_modal",["require","exports","tslib","external/react","external/classnames","modules/core/i18n","modules/clean/react/css","modules/clean/react/prompt/prompt_location","modules/clean/react/prompt/image","modules/clean/react/modal","modules/clean/react/prompt/button","modules/clean/user_education/user_education_client","modules/clean/user_education/user_education_loader","modules/clean/upsell/prompt_event_logger"],function(e,t,n,r,o,i,s,a,c,p,l,m,u,d){"use strict";function _(e){m.UEClient.sendEvent("OnboardingPromptModal","Shown",{name:e})}function f(e){m.UEClient.sendEvent("OnboardingPromptModal","ConfirmButtonClicked",{name:e})}Object.defineProperty(t,"__esModule",{value:!0});var h=function(e){var t=r.createElement(p.Modal,{id:e.id,className:e.className,title:e.title,acceptButtonText:e.acceptButtonText,clickOutToClose:!1,showX:e.showX},e.children),n=t.type.prototype;return n.componentDidMount&&(n._componentDidMount=n.componentDidMount,delete n.componentDidMount),t},g=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onShow=function(){t.state_manager.onShow(),t.props.campaign.onboardingModuleName&&_(t.props.campaign.onboardingModuleName)},t.onConfirm=function(e){t.state_manager.onConfirm(e),t.props.campaign.content.confirmInNewTab?setTimeout(function(){t.close()},0):t.state_manager.getShouldUsePost()||(t.close(),t.props.campaign.onboardingModuleName&&(f(t.props.campaign.onboardingModuleName),t.state_manager.eventLogger.recordEvent("onboarding_confirmed")))},t.onDismiss=function(e){t.state_manager.onDismiss(e),t.close()},t.onRemindMeLater=function(e){t.state_manager.onDismiss(e,{remindMeLater:!0}),t.close()},t.attachListenersToChildren=function(e){t.state_manager.attachListenersToChildren(e,t.onConfirm,t.onDismiss)},t}return n.__extends(t,e),t.shouldDisplayHomeModal=function(e){return!(e.campaign.isHomeOnboardingEnabled&&e.campaign.onboardingModuleName&&["home_v1","home_v0"].indexOf(e.campaign.onboardingModuleName)===-1)},t.kickstartOnboarding=function(e){e.campaign.onboardingModuleName&&(u.UELoader.notifyModuleToLoad(e.campaign.onboardingModuleName),_(e.campaign.onboardingModuleName),f(e.campaign.onboardingModuleName));var t=new d.PromptEventLogger(e);t.recordClientImpression(),t.recordConfirm(),t.recordEvent("onboarding_confirmed_no_prompt")},t.prototype.componentWillMount=function(){this.props.campaign.onboardingModuleName&&u.UELoader.notifyModuleToLoad(this.props.campaign.onboardingModuleName)},t.prototype.close=function(){p.Modal.close()},t.prototype.render=function(){var e=o((n={"dfb-modal":"dfb"===this.props.campaign.campaignTypeId,"pro-modal":"dfb"!==this.props.campaign.campaignTypeId},n["db-modal-custom-"+this.props.campaign.campaignName]=!!this.props.campaign.campaignName,n[this.props.campaign.content.modalStyle||""]=!!this.props.campaign.content.modalStyle,n["show-upsell-modal"]=!0,n)),t=this.props.isPreview?h:p.Modal;return r.createElement(t,{id:this.props.campaign.modalId,className:e,title:this.props.campaign.content.title,clickOutToClose:!0,acceptButtonText:null,onDismiss:this.onDismiss,onShow:this.onShow,showX:!0,isPreview:this.props.isPreview||!1},this.renderImage(),this.renderSubtext(),this.renderButtons(),this.renderBottomText());var n},t.prototype.renderButtons=function(){return r.createElement(l.PromptButtons,{campaign:this.props.campaign,confirmIsPost:this.state_manager.getShouldUsePost(),confirmUrl:this.state_manager.getConfirmUrl(),onConfirm:this.onConfirm,onDismiss:this.onDismiss,onRemindMeLater:this.onRemindMeLater})},t.prototype.renderImage=function(){return this.props.campaign.content.imageUrl?r.createElement(c.Image,{src:this.props.campaign.content.imageUrl,srcHiRes:this.props.campaign.content.imageUrlHiRes,alt:this.props.campaign.content.confirmText||i._("Main modal image.")}):void 0},t.prototype.renderBottomText=function(){return this.props.campaign.content.bottomText?r.createElement("div",{className:"bottom-text",dangerouslySetInnerHTML:l.sanitizeOptionalHTML(this.props.campaign.content.bottomText),ref:this.attachListenersToChildren}):void 0},t.prototype.renderSubtext=function(){return r.createElement("div",{className:"subtext",dangerouslySetInnerHTML:l.sanitizeOptionalHTML(this.props.campaign.content.subtext),ref:this.attachListenersToChildren})},t.displayName="HomeModalWithoutCSS",t})(a.PromptLocationWithDefaultState);t.HomeModalWithCSS=s(g,["/static/css/upsell/prompt_pagelet-vflbYkUc5.css","/static/css/upsell/upsell_modal-vfl_Ov87f.css"]);var v=(function(e){function o(t){var n=e.call(this,t)||this;return n.state={modalInstance:o.showInstance(t)},n}return n.__extends(o,e),o.showInstance=function(e){if(t.HomeModalWithCSS.shouldDisplayHomeModal(e)){var n=r.createElement(t.HomeModalWithCSS,e);return p.Modal.showInstance(n)}return g.kickstartOnboarding(e),null},o.prototype.render=function(){return null},o})(r.Component);t.HomeModal=v}),define("modules/clean/react/prompt/image",["require","exports","tslib","external/react"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(t,e),t.prototype.render=function(){var e=this.props.srcHiRes?this.props.srcHiRes+" 2x":void 0;return r.createElement("img",{src:this.props.src,srcSet:e,alt:this.props.alt,onLoad:this.props.onLoad})},t})(r.Component);t.Image=o}),define("modules/clean/react/prompt/prompt_location",["require","exports","tslib","external/react","modules/clean/react/prompt/campaign_state_manager"],function(e,t,n,r,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=(function(e){function t(t,n){var r=e.call(this,t)||this;return r.state=n,r.state_manager=new o.CampaignStateManager(r),r}return n.__extends(t,e),t})(r.Component);t.PromptLocation=i;var s=(function(e){function t(t){return e.call(this,t,{isConfirmed:!1,isDismissed:!1,isShown:!1})||this}return n.__extends(t,e),t})(i);t.PromptLocationWithDefaultState=s}),define("modules/clean/react/sprite_div",["require","exports","tslib","external/classnames","external/react","external/react-dom-factories","external/prop-types","modules/clean/react/sprite"],function(e,t,n,r,o,i,s,a){"use strict";var c=o.createElement,p=i.div;return(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(t,e),t.prototype.render=function(){var e,t=this.props.group,n=this.props.name,o=this.props.text,i=this.props.alt,s=r(["sprite-frame","small","icon-"+this.props.spritePosition]),l=p({className:s,key:0},c(a.Sprite,{group:t,name:n,alt:i})),m=p({className:"sprite-text",key:1},o);switch(this.props.spritePosition){case"left":e=[l,m];break;case"right":e=[m,l]}return p({className:"sprite-div"},e)},t.displayName="SpriteDiv",t.propTypes={group:s.string.isRequired,name:s.string.isRequired,text:s.oneOfType([s.string,s.array]),alt:s.string,spritePosition:s.oneOf(["left","right"])},t.defaultProps={alt:"",spritePosition:"left"},t})(o.Component)}),define("modules/clean/upsell/exception",["require","exports","modules/core/exception","modules/core/xhr"],function(e,t,n,r){"use strict";function o(e){
var t=e.severity,o=void 0===t?n.SEVERITY.CRITICAL:t;r.sendXhr("/prompt/log_jse",{severity:o})}function reportException(e){var r=e.err,o=e.tags,i=void 0===o?[]:o,s=e.severity,a=void 0===s?n.SEVERITY.CRITICAL:s,c=e.exc_extra,p=void 0===c?{}:c;i.push(t.TAGS.PROMPT),i.push(t.TAGS.MEGAPHONE),n.reportException({err:r,tags:i,severity:a,exc_extra:p}),t.logExceptionRate({severity:a})}function i(e){var r=e.err,o=e.js_controller_options,i=void 0===o?{}:o,s=e.severity,a=void 0===s?n.SEVERITY.CRITICAL:s,c=e.tags,p=void 0===c?[]:c,l={"campaign-name":"campaignName",location:"campaignLocationId"};for(var m in l)if(l.hasOwnProperty(m)){var u=l[m],d=i[u];d&&p.push("prompt-"+m+"-"+d)}t.reportException({err:r,tags:p,severity:a,exc_extra:i})}Object.defineProperty(t,"__esModule",{value:!0}),t.SEVERITY=n.SEVERITY,t.TAGS={MEGAPHONE:"megaphone",PROMPT:"prompt",PROMPT_ADMIN:"prompt-admin",PROMPT_REACT_LOADER:"prompt-react-loader",PROMPT_HA_LOADER:"prompt-ha-loader",PROMPT_LOADER:"prompt-loader",PROMPT_MAIN_AND_ACCOUNT_HEADER_LOADER:"prompt-main-and-account-header-loader",PROMPT_MUTUALLY_EXCLUSIVE_LOADER:"prompt-mutually-exclusive-loader",LEGACY_TOP_NOTIFICATIONS:"legacy-top-notifications"},t.logExceptionRate=o,t.reportException=reportException,t.reportJsControllerException=i}),define("modules/clean/upsell/legacy_prompt_event_logging",["require","exports","modules/core/uri","modules/clean/ajax_minimal"],function(e,t,n,r){"use strict";function o(e,t){var r={campaign_id:t.campaignId.toString()};if(t.versionId&&(r.campaign_id=t.versionId.toString(),r.version_id=t.versionId.toString()),"number"==typeof t.promptQueriedAtMs&&(r.prompt_queried_at_ms=t.promptQueriedAtMs.toString()),window&&window.performance&&window.performance.now){var o=Math.round(window.performance.now());r.delta_from_request_start_ms=o.toString()}return t.activeUserId&&(r._subject_uid=String(t.activeUserId)),t.requestId&&(r.prompt_parent_request_id=t.requestId),t.eventName&&(r.event_name=t.eventName),void 0!==t.remindMeLater&&(r.remind_me_later=(!!t.remindMeLater).toString()),t.csrfToken&&(r.csrf_token=encodeURIComponent(t.csrfToken)),t.csrfTokenType&&(r.csrf_token_type=encodeURIComponent(t.csrfTokenType)),new n.URI({path:e,query:r})}Object.defineProperty(t,"__esModule",{value:!0}),t.getUpsellControllerURI=o;var i=(function(){function e(e){this.params=e}return e.prototype.logImpression=function(){var e=o("/prompt/log_impression",this.params);r.post(e.toString(),"")},e.prototype.logDismissal=function(){var e=o("/prompt/dismiss",this.params);r.post(e.toString(),"")},e})();t.LegacyEventLogger=i}),define("modules/clean/upsell/prompt_event_emitter",["require","exports","external/eventemitter3"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Events={REACT_HA_DID_UPDATE:"REACT_HA_DID_UPDATE"},t.Emitter=new n}),define("modules/clean/upsell/prompt_event_logger",["require","exports","jquery","modules/clean/ajax","modules/clean/upsell/upsell_controller","modules/clean/upsell/legacy_prompt_event_logging"],function(e,t,n,r,o,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=(function(){function e(e){this.campaignProps=e}return e.prototype.recordClientImpression=function(){var e=this.getUpsellControllerURI("/prompt/log_impression");this.recordAck(e)},e.prototype.recordConfirm=function(){var e=this.getUpsellControllerURI("/prompt/confirm");this.recordAck(e,o.ON_CONFIRM_EVENT_NAME)},e.prototype.recordDismiss=function(e){var t=this.getUpsellControllerURI("/prompt/dismiss",{remindMeLater:e});this.recordAck(t,o.ON_DISMISS_EVENT_NAME)},e.prototype.recordEvent=function(e){var t=this.getUpsellControllerURI("/prompt/log_event",{eventName:e});this.recordAck(t)},e.prototype.recordAck=function(e,t){var n=this;r.SilentBackgroundRequest({type:"POST",url:e.toString()}).done(function(e){t&&n.triggerExternalEvent(t)})},e.prototype.getUpsellControllerURI=function(e,t){return i.getUpsellControllerURI(e,{campaignId:this.campaignProps.campaign.campaignId,versionId:this.campaignProps.campaign.versionId,activeUserId:this.campaignProps.subjectUser,promptQueriedAtMs:this.campaignProps.promptQueriedAtMs,requestId:this.campaignProps.requestId,csrfToken:this.campaignProps.csrfToken,csrfTokenType:this.campaignProps.csrfTokenType,eventName:t&&t.eventName,remindMeLater:t&&t.remindMeLater})},e.prototype.triggerExternalEvent=function(e){n(document).trigger(e,{campaignName:this.campaignProps.campaign.campaignName})},e})();t.PromptEventLogger=s}),define("modules/clean/upsell/prompt_loader",["require","exports","jquery","modules/clean/deprecated/uirequest","modules/clean/prompt/react_loader","modules/clean/prompt/ha_loader","modules/clean/upsell/exception","modules/clean/user_education/user_education_loader"],function(e,t,n,r,o,i,s,a){"use strict";function c(){return window.performance&&window.performance.mark&&window.performance.measure&&window.location.search.indexOf("show_debug_spans")>-1}function p(e){new v(e).didCampaignForUserEducationLoad()||a.UELoader.notifyModuleToLoad(null)}function l(e){return{userID:e.user_id,controller:e.controller,action:e.action}}function m(){return!!n("#top-notification-bar-container").length}function u(){n(".db-modal-overlay").is(":visible")||n("#db-modal-upsell-home-modal").addClass("show-upsell-modal").trigger("show-upsell-modal")}function d(e,t,n){return new Promise(function(i,s){try{new r(e,"/prompt/main_campaign",{data:{ref_controller:t.controller,ref_action:t.action,in_app:t.in_app,sprite_group:t.sprite_group,skip_main_campaign:n},dataType:"json",subject_user:t.user_id,success:function(e){var n=e.data.account_header_campaign_props,r=e.data.main_campaign_props;r?o.initialize_react({userID:t.user_id,controller:t.controller,action:t.action,campaigns:[r]}):(u(),p(e)),n&&o.initialize_react({userID:t.user_id,controller:t.controller,action:t.action,campaigns:[n]}),i(new v(e))}})}catch(e){_(t,n,e),s()}})}function _(e,t,n){s.reportException({err:n,tags:[s.TAGS.PROMPT_MAIN_AND_ACCOUNT_HEADER_LOADER],exc_extra:{param_user_id:e.user_id,param_controller:e.controller,param_action:e.action,param_in_app:e.in_app,param_sprite_group:e.sprite_group,param_options_skip_main_campaign:t}})}function f(){return b.waitFor()}function h(){b.reset()}function g(e){var t=c();t&&window.performance.mark("PromptLoader init start");var r=m(),o=n("#prompt-silo .main-silo");try{var a=d(o,e,e.mutually_exclusive_loading&&r);return e.mutually_exclusive_loading?a.then(function(t){return(r?t.didAccountHeaderCampaignLoad():t.didMainCampaignLoad())?t:Promise.all([a,i.initialize_module(l(e))]).then(function(e){return e[0]})}):a=Promise.all([a,i.initialize_module(l(e))]).then(function(e){return e[0]}),a.then(function(e){return t&&(window.performance.mark("PromptLoader init end"),window.performance.measure("PromptLoader init","PromptLoader init start","PromptLoader init end")),b.resolve(e),e})}catch(t){return s.reportException({err:t,tags:[s.TAGS.PROMPT_LOADER],exc_extra:{param_config:e}}),b.reject(),Promise.reject(null)}}Object.defineProperty(t,"__esModule",{value:!0});var v=(function(){function e(e){this.response_data=e}return e.prototype.didCampaignLoad=function(e,t){for(var n=this.response_data.actions||[],r=0,o=n;r<o.length;r++){var i=o[r],s=i[1];if(i[2]===e&&s)return!t||s.indexOf(t)>=0}return!1},e.prototype.didHeaderBubbleLoad=function(){return this.didCampaignLoad("^body #prompt-silo .account-header-silo","header-bubble-container")||this.didCampaignLoad("^body #prompt-silo .account-header-react-silo","header-bubble-container")},e.prototype.didHeaderLinkLoad=function(){return!this.didHeaderBubbleLoad()&&(this.didCampaignLoad("^body #prompt-silo .account-header-silo","header-link")||this.didCampaignLoad("^body #prompt-silo .account-header-react-silo","header-link"))},e.prototype.didMainCampaignLoad=function(){return this.didHeaderBubbleLoad()||this.didCampaignLoad("^body #prompt-silo .main-silo")},e.prototype.didAccountHeaderCampaignLoad=function(){return this.didHeaderBubbleLoad()||this.didHeaderLinkLoad()},e.prototype.didCampaignForUserEducationLoad=function(){return this.didCampaignLoad("^body #prompt-silo .main-silo",'"onboardingModuleName":')&&!this.didCampaignLoad("^body #prompt-silo .main-silo",'"onboardingModuleName": null')},e.prototype.didAnyContentLoad=function(){for(var e=this.response_data.actions||[],t=0,n=e;t<n.length;t++){if(n[t][1])return!0}return!1},e})();t.ResponseParser=v;var y=(function(){function e(){this.waits=[],this.result=null}return e.prototype.reset=function(){this.result=null},e.prototype.waitFor=function(){var e=this;return this.result?Promise.resolve(this.result):new Promise(function(t,n){e.waits.push({resolve:t,reject:n})})},e.prototype.resolve=function(e){this.result=e,this.waits.forEach(function(t){return t.resolve(e)}),this.waits=[]},e.prototype.reject=function(){this.result=null,this.waits.forEach(function(e){return e.reject()}),this.waits=[]},e})(),b=new y;t.waitForPrompt=f,t.resetWait=h,t.initialize_module=g}),define("modules/clean/upsell/upsell_controller",["require","exports","jquery","modules/clean/ajax","modules/clean/upsell/exception","modules/core/dom","modules/core/uri"],function(e,t,n,r,o,i,s){"use strict";var a=(function(){function e(t,r,o){var i=this;this._keydown=this._keydown.bind(this),this.dismiss=this.dismiss.bind(this),this.confirm=this.confirm.bind(this),this.post_dismiss=this.post_dismiss.bind(this),this.post_confirm=this.post_confirm.bind(this),this.options=o,t.length>0&&t.one("click",function(e){return i.confirm(e)}),r.length>0&&r.one("click",function(e){var t=n(e.target).hasClass("remind-me-later");return i.dismiss(e,t)}),this.options.dismissWithKeys&&n(document).on("keydown",this._keydown),e.add_tk_params(t,{addTkParams:this.options.addTkParams,campaignId:this.options.campaignId,versionId:this.options.versionId,campaignLocationTkId:this.options.campaignLocationTkId}),t.add(r).addClass("enabled")}return e.initClass=function(){this.ON_SHOW_EVENT_NAME="db:prompt:show",this.ON_CONFIRM_EVENT_NAME="db:prompt:confirm",this.ON_DISMISS_EVENT_NAME="db:prompt:dismiss",this.PRE_CONFIRM_EVENT_NAME="db:prompt:pre-confirm",this.PRE_DISMISS_EVENT_NAME="db:prompt:pre-dismiss",this.CONFIRM="confirm",this.DISMISS="dismiss",this.LOG_IMPRESSION="log_impression"},e.prototype._keydown=function(e){if(27===e.keyCode||8===e.keyCode&&!i.focus_in_input())return e.preventDefault(),n(document).off("keydown",this._keydown),this.dismiss(e)},e.prototype._campaignUrl=function(t,n){var r=(function(){return t===e.CONFIRM?"/prompt/confirm":t===e.DISMISS?"/prompt/dismiss":t===e.LOG_IMPRESSION?"/prompt/log_impression":void 0})();if(this.options&&this.options.campaignId){var o=new s.URI({path:r}).updateQuery({campaign_id:this.options.campaignId});return this.options.versionId&&o.updateQuery({campaign_id:this.options.versionId,version_id:this.options.versionId}),t===e.DISMISS&&n&&o.updateQuery({remind_me_later:!0}),o.toString()}},e.prototype._confirmOrDismiss=function(e,t,o,i){var s=this;return"keydown"===e.type||o||(e.stopImmediatePropagation(),e.preventDefault()),r.SilentBackgroundRequest({type:"POST",url:t,subject_user:this.options.activeUserId,data:{prompt_queried_at_ms:this.options.promptQueriedAtMs,delta_from_request_start_ms:this.get_time_since_request_start(),prompt_parent_request_id:this.options.requestId}}).done(function(t){return"keydown"===e.type||o||e.target.click(),n(document).trigger(i,s.options)})},e.prototype.dismiss=function(t,r){var o=this._campaignUrl(e.DISMISS,r);return o&&this._confirmOrDismiss(t,o,!1,e.ON_DISMISS_EVENT_NAME),n(document).trigger(e.PRE_DISMISS_EVENT_NAME,this.options)},e.prototype.confirmUrl=function(e){var t=n(e.currentTarget);return(function(){return t.is("button, input")&&"submit"===t.attr("type")?n(e.currentTarget).closest("form").attr("action"):t.is("a")?n(e.currentTarget).attr("href"):void 0})()||this.options.confirmUrl},e.prototype.confirmInNewTab=function(e){var t=n(e.currentTarget),r=(function(){return t.is("button, input")&&"submit"===t.attr("type")?n(e.currentTarget).closest("form").attr("target"):t.is("a")?n(e.currentTarget).attr("target"):void 0})();return r?"_blank"===r:this.options.confirmInNewTab},e.prototype.confirm=function(t){var r=this._campaignUrl(e.CONFIRM);return r&&this._confirmOrDismiss(t,r,this.confirmInNewTab(t),e.ON_CONFIRM_EVENT_NAME),n(document).trigger(e.PRE_CONFIRM_EVENT_NAME,this.options)},e.prototype.get_time_since_request_start=function(){if(window.performance&&window.performance.timing&&window.performance.timing.navigationStart)return(new Date).getTime()-window.performance.timing.navigationStart},e.prototype.log_impression=function(){var t=this._campaignUrl(e.LOG_IMPRESSION);if(t)return r.SilentBackgroundRequest({type:"POST",url:t,subject_user:this.options.activeUserId,data:{prompt_queried_at_ms:this.options.promptQueriedAtMs,delta_from_request_start_ms:this.get_time_since_request_start(),prompt_parent_request_id:this.options.requestId}})},e.prototype.log_event=function(e){if(this.options&&this.options.campaignId){var t=new s.URI({path:"/prompt/log_event"}).updateQuery({event_name:e,campaign_id:this.options.campaignId});return this.options.versionId&&t.updateQuery({campaign_id:this.options.versionId,version_id:this.options.versionId}),r.SilentBackgroundRequest({type:"POST",url:t.toString(),subject_user:this.options.activeUserId,data:{prompt_queried_at_ms:this.options.promptQueriedAtMs,delta_from_request_start_ms:this.get_time_since_request_start(),prompt_parent_request_id:this.options.requestId}})}},e.prototype.post_dismiss=function(){var e=this._dismissUrl();if(e)return r.SilentBackgroundRequest({type:"POST",url:e,data:{prompt_queried_at_ms:this.options.promptQueriedAtMs,delta_from_request_start_ms:this.get_time_since_request_start(),prompt_parent_request_id:this.options.requestId}})},e.prototype.post_confirm=function(){var e=this._confirmUrl();if(e)return r.SilentBackgroundRequest({type:"POST",url:e,data:{prompt_queried_at_ms:this.options.promptQueriedAtMs,delta_from_request_start_ms:this.get_time_since_request_start(),prompt_parent_request_id:this.options.requestId}})},e.add_tk_params=function(e,t){if(t.addTkParams){if(!t.campaignId||!t.campaignLocationTkId){var r=new Error("Missing campaignId or campaignLocationTkId.");return void o.reportJsControllerException({err:r,js_controller_options:t,severity:o.SEVERITY.NONCRITICAL})}return e.each(function(e,r){var o,i=n(r);i.is("a")?o="href":(i=i.closest("form"),o="action");var a=i.attr(o);if(i.length>0&&a){var c=s.URI.parse(a);return c.updateQuery({_tk:t.campaignLocationTkId,_camp:t.versionId||t.campaignId}),i.attr(o,c.toString())}})}},e.register_custom_controller=function(t){var r=t.on_show,o=t.on_confirm,i=t.on_dismiss,s=t.pre_confirm,a=t.pre_dismiss;if(r&&n(document).on(e.ON_SHOW_EVENT_NAME,r),o&&n(document).on(e.ON_CONFIRM_EVENT_NAME,o),i&&n(document).on(e.ON_DISMISS_EVENT_NAME,i),s&&n(document).on(e.PRE_CONFIRM_EVENT_NAME,s),a)return n(document).on(e.PRE_DISMISS_EVENT_NAME,a)},e.unregister_custom_controller=function(t){var r=t.on_show,o=t.on_confirm,i=t.on_dismiss,s=t.pre_confirm,a=t.pre_dismiss;if(r&&n(document).off(e.ON_SHOW_EVENT_NAME,r),o&&n(document).off(e.ON_CONFIRM_EVENT_NAME,o),i&&n(document).off(e.ON_DISMISS_EVENT_NAME,i),s&&n(document).off(e.PRE_CONFIRM_EVENT_NAME,s),a)return n(document).off(e.PRE_DISMISS_EVENT_NAME,a)},e})();return a.initClass(),a}),define("modules/clean/user_education/user_education_loader",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=(function(){function e(){this.loadMessage=null,this.callback=null}return e.prototype.notifyModuleToLoad=function(e){this.callback?(this.callback(e),this.callback=null):this.loadMessage={moduleName:e}},e.prototype.setLoadingCallback=function(e){this.loadMessage?e(this.loadMessage.moduleName):this.callback=e},e.prototype.reset=function(){this.loadMessage=null,this.callback=null},e})();t.UELoader=new n});
//# sourceMappingURL=pkg-prompt.min.js-vfl7QRIMI.map